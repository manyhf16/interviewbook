---
search:
    keywords: ['classloader','类加载']

---


# java中的类加载机制，ClassLoader是如何查找类的？

类似问法：描述一下 JVM 加载 class 文件的原理机制？

# 参考解答

## 1. 类加载的概念
类加载器(ClassLoader)是一组特殊的类，负责在运行时查找和加载其他类。

java中的类加载器分四个层次：
* Bootstrap ClassLoader (系统类加载器)
* Extension ClassLoader (扩展类加载器)
* App ClassLoader (应用程序类加载器)
* Custom ClassLoader (自定义类加载器)
为了称呼方便把它们分别称为 BC, EC, AC, CC 


## 2. 类加载的阶段
类加载分为3个阶段：加载、连接、初始化

类加载是通过 ClassLoader类加载器来完成的，其中重要方法有：
* loadClass(String name) 是根据类名称加载类，完成加载阶段的操作，只会涉及前两个阶段，不会执行初始化阶段
* findClass(String name) 是提供给自定义类加载器的一种扩展方式，自定义类加载器会优先使用父类类加载器和系统类加载器来加载类，如果它们俩无法找到类时，最后会调用自定义类加载器的findClass方法来加载类（jdk不推荐直接重写loadClass方法，而是重写findClass方法）
* defineClass(String name,byte[] bin,int offset, int limit) 是当类的字节码来源不是classpath上的文件时（例如，通过其它如网络、字节码生成技术生成的代表了类字节码的byte[]），可以调用此方法来完成加载类的工作。但它不应当被直接调用，而是通过findClass或loadClass间接调用

---